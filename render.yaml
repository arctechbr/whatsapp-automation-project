# render.yaml
# Arquivo de configuração FINAL para deploy no Render
# Inclui correções de sintaxe e interconexão de serviços (CORS e VITE_APP_BACKEND_URL)

services:
  # ====================
  # BANCO DE DADOS (PostgreSQL)
  # ====================
  - name: postgres-whatsapp
    type: pserv
    plan: free
    envVars:
      - key: POSTGRES_DB
        value: whatsapp_automation
      - key: POSTGRES_USER
        value: automation_user
      - key: POSTGRES_PASSWORD
        generateValue: true

  # ====================
  # BACKEND (FastAPI)
  # ====================
  - name: backend-whatsapp
    type: web
    plan: free
    env: python
    region: oregon
    rootDir: backend
    buildCommand: "pip install -r requirements.txt"
    startCommand: "uvicorn main:app --host 0.0.0.0 --port $PORT"
    healthCheckPath: /health
    envVars:
      # Conexão com o banco de dados
      - key: DATA
